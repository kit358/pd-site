<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>è‡³é«˜ã®ã‚¹ã‚¤ãƒ¼ãƒ„ãƒšã‚¢ãƒªãƒ³ã‚°è¨ºæ–­</title>
    <style>
        /* --- CSS: ãƒ‡ã‚¶ã‚¤ãƒ³éƒ¨åˆ† --- */
        :root {
            --bg-color: #fdfbf7;
            --primary-color: #8d6e63;
            --accent-color: #ffccbc;
            --text-color: #4e342e;
            --card-bg: #ffffff;
        }

        body {
            font-family: "Helvetica Neue", Arial, "Hiragino Kaku Gothic ProN", "Hiragino Sans", Meiryo, sans-serif;
            background-color: var(--bg-color);
            color: var(--text-color);
            margin: 0;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            background-color: var(--card-bg);
            width: 100%;
            max-width: 500px;
            padding: 30px;
            border-radius: 20px;
            box-shadow: 0 10px 25px rgba(0,0,0,0.05);
            text-align: center;
            position: relative;
            overflow: hidden;
        }

        h1 {
            font-size: 24px;
            margin-bottom: 20px;
            color: var(--primary-color);
        }

        .hidden {
            display: none;
        }

        /* è³ªå•ç”»é¢ */
        .progress-bar {
            width: 100%;
            height: 6px;
            background-color: #eee;
            border-radius: 3px;
            margin-bottom: 30px;
            overflow: hidden;
        }
        .progress-fill {
            height: 100%;
            background-color: var(--primary-color);
            width: 0%;
            transition: width 0.3s ease;
        }

        .question-text {
            font-size: 18px;
            margin-bottom: 30px;
            font-weight: bold;
            line-height: 1.5;
        }

        .options {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        button {
            background-color: var(--bg-color);
            border: 2px solid var(--primary-color);
            color: var(--text-color);
            padding: 15px;
            border-radius: 50px;
            font-size: 16px;
            cursor: pointer;
            transition: all 0.2s;
            outline: none;
        }

        button:hover {
            background-color: var(--primary-color);
            color: white;
        }

        button.start-btn {
            background-color: var(--primary-color);
            color: white;
            font-weight: bold;
            padding: 20px 40px;
            font-size: 18px;
        }

        /* çµæœç”»é¢ */
        .result-title {
            font-size: 16px;
            color: #888;
            margin-bottom: 10px;
        }

        .pairing-result {
            font-size: 28px;
            font-weight: bold;
            color: var(--primary-color);
            margin: 10px 0 20px;
            padding: 20px;
            border: 2px dashed var(--accent-color);
            border-radius: 10px;
            background-color: #fffaf0;
        }

        .score-area {
            font-size: 20px;
            margin-bottom: 20px;
            color: #f57c00;
        }

        .comment-box {
            text-align: left;
            background-color: #f5f5f5;
            padding: 15px;
            border-radius: 10px;
            font-size: 14px;
            margin-bottom: 30px;
            line-height: 1.6;
        }
        
        .comment-box strong {
            color: var(--primary-color);
        }

        .fade-in {
            animation: fadeIn 0.5s;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
    </style>
</head>
<body>

<div class="container">
    <div id="start-screen">
        <h1>ã‚¹ã‚¤ãƒ¼ãƒ„ãƒšã‚¢ãƒªãƒ³ã‚°è¨ºæ–­</h1>
        <p>å®Ÿé¨“ãƒ‡ãƒ¼ã‚¿ã¨ã‚¢ãƒ³ã‚±ãƒ¼ãƒˆçµæœã«åŸºã¥ãã€<br>ã‚ãªãŸã®ã€Œä»Šã€ã«æœ€é©ãªé£²ã¿ç‰©ã‚’<br>ç§‘å­¦çš„ã«ææ¡ˆã—ã¾ã™ã€‚</p>
        <div style="font-size: 50px; margin: 30px 0;">ğŸ©â˜•ï¸</div>
        <button class="start-btn" onclick="startQuiz()">è¨ºæ–­ã‚’ã¯ã˜ã‚ã‚‹</button>
    </div>

    <div id="quiz-screen" class="hidden">
        <div class="progress-bar"><div class="progress-fill" id="progress"></div></div>
        <div id="question-container" class="fade-in">
            <div class="question-text" id="question-text">è³ªå•ãŒã“ã“ã«è¡¨ç¤ºã•ã‚Œã¾ã™</div>
            <div class="options" id="options-container">
                </div>
        </div>
    </div>

    <div id="result-screen" class="hidden fade-in">
        <div class="result-title">ã‚ãªãŸã«ãŠã™ã™ã‚ã®ãƒšã‚¢ãƒªãƒ³ã‚°ã¯â€¦</div>
        <div class="pairing-result" id="result-drink"></div>
        <div class="score-area" id="result-score"></div>
        
        <div class="comment-box">
            <p id="result-science-comment"></p>
            <p id="result-survey-comment" style="margin-top:10px; font-size:12px; color:#666;"></p>
        </div>

        <button class="start-btn" onclick="location.reload()">ã‚‚ã†ä¸€åº¦è¨ºæ–­ã™ã‚‹</button>
    </div>
</div>

<script>
    /* --- JavaScript: ãƒ­ã‚¸ãƒƒã‚¯éƒ¨åˆ† --- */

    // å®Ÿé¨“ãƒ‡ãƒ¼ã‚¿ã«åŸºã¥ãã‚¹ã‚¤ãƒ¼ãƒ„ã”ã¨ã®æ¨å¥¨é£²ã¿ç‰©ãƒªã‚¹ãƒˆ
    // logic: "milk"=ç‰›ä¹³, "coffee"=ã‚³ãƒ¼ãƒ’ãƒ¼, "tea"=ç´…èŒ¶, "green_tea"=ãŠèŒ¶, "juice"=ã‚¸ãƒ¥ãƒ¼ã‚¹
    const pairingsDB = {
        "donut": [
            { id: "milk", name: "ç‰›ä¹³", score: 4.00, comment: "å®Ÿé¨“ãƒ‡ãƒ¼ã‚¿ã§å”¯ä¸€ã®æº€ç‚¹ã‚’è¨˜éŒ²ã€‚ãƒ‰ãƒ¼ãƒŠãƒ„ã®æ²¹åˆ†ã‚’ç‰›ä¹³ãŒæ´—ã„æµã™ã€ç§‘å­¦çš„ã«æœ€å¼·ã®çµ„ã¿åˆã‚ã›ã§ã™ã€‚" },
            { id: "coffee", name: "ãƒ–ãƒ©ãƒƒã‚¯ã‚³ãƒ¼ãƒ’ãƒ¼", score: 3.89, comment: "ç”˜ã¿ã¨è‹¦å‘³ã®ãƒãƒ©ãƒ³ã‚¹ãŒçµ¶å¦™ã€‚ç‹é“ã®çµ„ã¿åˆã‚ã›ã¨ã—ã¦éå¸¸ã«é«˜ã„è©•ä¾¡ã‚’å¾—ã¦ã„ã¾ã™ã€‚" },
            { id: "tea", name: "ç´…èŒ¶", score: 3.78, comment: "ã•ã£ã±ã‚Šã¨æ¥½ã—ã¿ãŸã„ãªã‚‰ç´…èŒ¶ãŒãŠã™ã™ã‚ã€‚ãƒ‰ãƒ¼ãƒŠãƒ„ã®é‡ã•ã‚’è»½æ¸›ã—ã¦ãã‚Œã¾ã™ã€‚" }
        ],
        "chou": [ // ã‚·ãƒ¥ãƒ¼ã‚¯ãƒªãƒ¼ãƒ 
            { id: "coffee", name: "ã‚³ãƒ¼ãƒ’ãƒ¼", score: 3.20, comment: "ã‚¯ãƒªãƒ¼ãƒ ã®æ¿ƒåšãªç”˜ã•ã‚’ã€ã‚³ãƒ¼ãƒ’ãƒ¼ã®è‹¦å‘³ãŒå¼•ãç· ã‚ã¾ã™ã€‚" },
            { id: "milk", name: "ç‰›ä¹³", score: 3.11, comment: "ã‚¯ãƒªãƒ¼ãƒ ã¨ç”Ÿåœ°ã®ä¸¡æ–¹ã«ç‰›ä¹³ã®æˆåˆ†ãŒå«ã¾ã‚Œã‚‹ãŸã‚ã€èª¿å’Œåº¦ã¯æŠœç¾¤ã§ã™ã€‚" },
            { id: "tea", name: "ç´…èŒ¶", score: 3.10, comment: "é¦™ã‚Šã®ç›¸æ€§ã‚’æ¥½ã—ã¿ãŸã„æ–¹ã«ã€‚ã‚¯ãƒªãƒ¼ãƒ ã®é¢¨å‘³ã‚’é‚ªé­”ã—ã¾ã›ã‚“ã€‚" }
        ],
        "cookie": [
            { id: "milk", name: "ç‰›ä¹³", score: 3.80, comment: "å£ã®ä¸­ã®æ°´åˆ†ã‚’è£œã„ã¤ã¤ã€ã‚¯ãƒƒã‚­ãƒ¼ã®ãƒã‚¿ãƒ¼ã®é¢¨å‘³ã‚’å¼•ãç«‹ã¦ã¾ã™ã€‚" },
            { id: "tea", name: "ç´…èŒ¶", score: 3.20, comment: "å„ªé›…ãªãƒ†ã‚£ãƒ¼ã‚¿ã‚¤ãƒ ã«ã€‚ã‚µã‚¯ã‚µã‚¯ã—ãŸé£Ÿæ„Ÿã¨æ¸©ã‹ã„ç´…èŒ¶ã¯ãƒ™ã‚¹ãƒˆãƒãƒƒãƒã€‚" },
            { id: "coffee", name: "ã‚³ãƒ¼ãƒ’ãƒ¼", score: 2.89, comment: "ç”˜ã„ã‚¯ãƒƒã‚­ãƒ¼ãªã‚‰ã€è‹¦å‘³ã®ã‚ã‚‹ã‚³ãƒ¼ãƒ’ãƒ¼ã§ãƒãƒ©ãƒ³ã‚¹ã‚’å–ã‚‹ã®ãŒæ­£è§£ã§ã™ã€‚" }
        ],
        "castella": [
            { id: "milk", name: "ç‰›ä¹³", score: 3.89, comment: "ã‚«ã‚¹ãƒ†ãƒ©ã®åµã®é¢¨å‘³ã¨ç‰›ä¹³ã¯ç›¸æ€§æŠœç¾¤ã€‚æ‡ã‹ã—ãã‚‚å®Œç’§ãªå‘³ã‚ã„ã§ã™ã€‚" },
            { id: "tea", name: "ç´…èŒ¶", score: 3.44, comment: "ã‚«ã‚¹ãƒ†ãƒ©ã®ç”˜ã•ã‚’ç´…èŒ¶ãŒä¸Šå“ã«ã¾ã¨ã‚ä¸Šã’ã¾ã™ã€‚" },
            { id: "green_tea", name: "æ—¥æœ¬èŒ¶", score: 3.20, comment: "å’Œè“å­ã«è¿‘ã„ã‚«ã‚¹ãƒ†ãƒ©ã«ã¯ã€æ¸©ã‹ã„æ—¥æœ¬èŒ¶ã‚‚éå¸¸ã«ã‚ˆãåˆã„ã¾ã™ã€‚" }
        ],
        "daifuku": [
            { id: "green_tea", name: "æ—¥æœ¬èŒ¶ï¼ˆç·‘èŒ¶ï¼‰", score: 3.00, comment: "å’Œè“å­ã«ã¯ã‚„ã¯ã‚Šæ—¥æœ¬èŒ¶ã€‚ã‚ã‚“ã“ã®ç”˜ã•ã‚’å¼•ãç«‹ã¦ã‚‹é‰„æ¿ã®çµ„ã¿åˆã‚ã›ã§ã™ã€‚" },
            { id: "tea", name: "ç´…èŒ¶", score: 2.56, comment: "æ„å¤–ãªçµ„ã¿åˆã‚ã›ã§ã™ãŒã€ã‚ã‚“ã“ã¨ç´…èŒ¶ã®ç›¸æ€§ã¯å®Ÿé¨“ã§ã‚‚æ‚ªããªã„çµæœãŒå‡ºã¦ã„ã¾ã™ã€‚" },
            { id: "coffee", name: "ã‚³ãƒ¼ãƒ’ãƒ¼", score: 2.11, comment: "å’Œãƒ¢ãƒ€ãƒ³ã®æ¥½ã—ã¿æ–¹ã€‚ã‚ã‚“ã“ã®å¼·ã•ã«è² ã‘ãªã„ã‚³ãƒ¼ãƒ’ãƒ¼ã‚’é¸ã¶ã®ãŒã‚³ãƒ„ã€‚" }
        ],
        "choco": [ // ãƒãƒ§ã‚³ç³»ï¼ˆãƒ‡ãƒ¼ã‚¿ãŒãªã„å ´åˆã¯ã‚¢ãƒ³ã‚±ãƒ¼ãƒˆã¨é¡ä¼¼ã‚¹ã‚¤ãƒ¼ãƒ„ã‹ã‚‰æ¨æ¸¬ï¼‰
            { id: "coffee", name: "ã‚³ãƒ¼ãƒ’ãƒ¼", score: 3.50, comment: "ã‚¢ãƒ³ã‚±ãƒ¼ãƒˆã§æœ€ã‚‚æ”¯æŒã•ã‚ŒãŸçµ„ã¿åˆã‚ã›ã€‚ã‚«ã‚«ã‚ªã®è‹¦å‘³ã¨ã‚³ãƒ¼ãƒ’ãƒ¼ã®é¦™ã‚ŠãŒå…±é³´ã—ã¾ã™ã€‚" },
            { id: "milk", name: "ç‰›ä¹³", score: 3.30, comment: "æ¿ƒåšãªãƒãƒ§ã‚³ã‚’ã¾ã‚ã‚„ã‹ã«ä¸­å’Œã—ãŸã„ãªã‚‰ç‰›ä¹³ä¸€æŠã§ã™ã€‚" },
            { id: "tea", name: "ç´…èŒ¶", score: 3.00, comment: "å°‘ã—é…¸å‘³ã®ã‚ã‚‹ãƒãƒ§ã‚³ã‚±ãƒ¼ã‚­ãªã©ã¯ç´…èŒ¶ãŒã‚ˆãåˆã„ã¾ã™ã€‚" }
        ],
        "pudding": [ // ãƒ—ãƒªãƒ³/ã‚¼ãƒªãƒ¼
            { id: "coffee", name: "ã‚³ãƒ¼ãƒ’ãƒ¼", score: 3.10, comment: "ã‚«ãƒ©ãƒ¡ãƒ«ã®è‹¦å‘³ã¨ã‚³ãƒ¼ãƒ’ãƒ¼ã¯å…„å¼Ÿã®ã‚ˆã†ãªç›¸æ€§ã®è‰¯ã•ã§ã™ã€‚" },
            { id: "tea", name: "ç´…èŒ¶", score: 3.00, comment: "ã¤ã‚‹ã£ã¨ã—ãŸé£Ÿæ„Ÿã‚’é‚ªé­”ã—ãªã„ã€ã‚¹ãƒˆãƒ¬ãƒ¼ãƒˆãƒ†ã‚£ãƒ¼ãŒãŠã™ã™ã‚ã€‚" }
        ],
        "cheese": [ // ãƒãƒ¼ã‚ºã‚±ãƒ¼ã‚­
            { id: "tea", name: "ç´…èŒ¶", score: 3.40, comment: "ãƒãƒ¼ã‚ºã®é…¸å‘³ã¨ç´…èŒ¶ã®æ¸‹ã¿ã¯ã€ãŠäº’ã„ã‚’é«˜ã‚åˆã†é–¢ä¿‚ã§ã™ã€‚" },
            { id: "coffee", name: "ã‚³ãƒ¼ãƒ’ãƒ¼", score: 3.30, comment: "æ¿ƒåšãªãƒãƒ¼ã‚ºã‚±ãƒ¼ã‚­ã«ã¯æ·±ç…ã‚Šã®ã‚³ãƒ¼ãƒ’ãƒ¼ãŒã‚ˆãåˆã„ã¾ã™ã€‚" }
        ]
    };

    // è³ªå•ãƒªã‚¹ãƒˆ
    // type: "filter"ã¯ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®é£²ã‚ã‚‹ã‚‚ã®ã‚’åˆ¤å®šã€"target"ã¯æœ€çµ‚çš„ãªã‚¹ã‚¤ãƒ¼ãƒ„æ±ºå®š
    const questions = [
        {
            text: "Q1. ã‚³ãƒ¼ãƒ’ãƒ¼ã¯é£²ã‚ã¾ã™ã‹ï¼Ÿ",
            type: "filter",
            key: "canCoffee",
            options: [
                { text: "å¤§å¥½ãï¼ˆãƒ–ãƒ©ãƒƒã‚¯ã‚‚OKï¼‰", value: true },
                { text: "ãƒŸãƒ«ã‚¯ã‚„ç ‚ç³–ãŒã‚ã‚Œã°é£²ã‚ã‚‹", value: true },
                { text: "è‹¦æ‰‹ï¼é£²ã‚ãªã„", value: false }
            ]
        },
        {
            text: "Q2. ç´…èŒ¶ã¯é£²ã‚ã¾ã™ã‹ï¼Ÿ",
            type: "filter",
            key: "canTea",
            options: [
                { text: "ã‚ˆãé£²ã‚€", value: true },
                { text: "ãŸã¾ã«é£²ã‚€", value: true },
                { text: "è‹¦æ‰‹ï¼é£²ã‚ãªã„", value: false }
            ]
        },
        {
            text: "Q3. ç‰›ä¹³ï¼ˆãƒŸãƒ«ã‚¯ï¼‰ãã®ã‚‚ã®ã¯å¥½ãã§ã™ã‹ï¼Ÿ",
            type: "filter",
            key: "canMilk",
            options: [
                { text: "å¥½ãï¼ˆãã®ã¾ã¾é£²ã‚ã‚‹ï¼‰", value: true },
                { text: "æ–™ç†ã‚„ã‚«ãƒ•ã‚§ã‚ªãƒ¬ãªã‚‰OK", value: true },
                { text: "è‹¦æ‰‹ï¼ãŠè…¹ãŒã”ã‚ã”ã‚ã™ã‚‹", value: false }
            ]
        },
        {
            text: "Q4. æ—¥æœ¬èŒ¶ï¼ˆç·‘èŒ¶ãªã©ï¼‰ã¯é£²ã¿ã¾ã™ã‹ï¼Ÿ",
            type: "filter",
            key: "canGreenTea",
            options: [
                { text: "ã‚ˆãé£²ã‚€", value: true },
                { text: "ã‚ã¾ã‚Šé£²ã¾ãªã„", value: true }
            ]
        },
        {
            text: "Q5. ç”˜ã„ã‚‚ã®ã‚’é£Ÿã¹ã‚‹æ™‚ã€é£²ã¿ç‰©ã«æ±‚ã‚ã‚‹å½¹å‰²ã¯ï¼Ÿ",
            type: "pref", // å‘³ã®å¥½ã¿ï¼ˆä»Šå›ã¯ã‚·ãƒ³ãƒ—ãƒ«åŒ–ã®ãŸã‚ãƒ­ã‚°ã®ã¿ä½¿ç”¨ï¼‰
            options: [
                { text: "å£ã®ä¸­ã‚’ã•ã£ã±ã‚Šã•ã›ãŸã„", value: "refresh" },
                { text: "ç”˜ã•ã‚’å¼•ãç«‹ã¦ã¦ã»ã—ã„", value: "enhance" }
            ]
        },
        {
            text: "Q6. æ¿ƒåšãªã‚¹ã‚¤ãƒ¼ãƒ„ã¯å¥½ãã§ã™ã‹ï¼Ÿ",
            type: "pref",
            options: [
                { text: "å¤§å¥½ã", value: "rich" },
                { text: "ã©ã¡ã‚‰ã‹ã¨è¨€ãˆã°ã•ã£ã±ã‚Šæ´¾", value: "light" }
            ]
        },
        {
            text: "Q7. ã‚¯ãƒªãƒ¼ãƒ ç³»ã¯ã‚ˆãé£Ÿã¹ã¾ã™ã‹ï¼Ÿ",
            type: "pref",
            options: [
                { text: "ã‚ˆãé£Ÿã¹ã‚‹", value: "cream_yes" },
                { text: "ã‚ã¾ã‚Šé£Ÿã¹ãªã„", value: "cream_no" }
            ]
        },
        {
            text: "Q8. ãƒãƒ§ã‚³ç³»ã¯ã‚ˆãé¸ã³ã¾ã™ã‹ï¼Ÿ",
            type: "pref",
            options: [
                { text: "ã‚ˆãé¸ã¶", value: "choco_yes" },
                { text: "ã‚ã¾ã‚Šé¸ã°ãªã„", value: "choco_no" }
            ]
        },
        {
            text: "Q9. å’Œè“å­ã¯ã‚ˆãé£Ÿã¹ã¾ã™ã‹ï¼Ÿ",
            type: "pref",
            options: [
                { text: "ã‚ˆãé£Ÿã¹ã‚‹", value: "wagashi_yes" },
                { text: "ã‚ã¾ã‚Šé£Ÿã¹ãªã„", value: "wagashi_no" }
            ]
        },
        {
            text: "Q10. ä»Šã€é£Ÿã¹ã‚ˆã†ã¨ã—ã¦ã„ã‚‹ã‚¹ã‚¤ãƒ¼ãƒ„ã‚’é¸ã‚“ã§ãã ã•ã„ã€‚",
            type: "target",
            options: [
                { text: "ãƒ‰ãƒ¼ãƒŠãƒ„", value: "donut" },
                { text: "ã‚·ãƒ¥ãƒ¼ã‚¯ãƒªãƒ¼ãƒ ", value: "chou" },
                { text: "ã‚¯ãƒƒã‚­ãƒ¼ï¼ç„¼ãè“å­", value: "cookie" },
                { text: "ã‚«ã‚¹ãƒ†ãƒ©", value: "castella" },
                { text: "å¤§ç¦ï¼å’Œè“å­", value: "daifuku" },
                { text: "ãƒãƒ§ã‚³ã‚±ãƒ¼ã‚­ï¼ãƒãƒ§ã‚³ç³»", value: "choco" },
                { text: "ãƒãƒ¼ã‚ºã‚±ãƒ¼ã‚­", value: "cheese" },
                { text: "ãƒ—ãƒªãƒ³ï¼ã‚¼ãƒªãƒ¼", value: "pudding" }
            ]
        }
    ];

    let currentQuestionIndex = 0;
    let userPreferences = {
        canCoffee: true,
        canTea: true,
        canMilk: true,
        canGreenTea: true
    };
    let selectedSweet = "";

    // è¨ºæ–­é–‹å§‹
    function startQuiz() {
        document.getElementById("start-screen").classList.add("hidden");
        document.getElementById("quiz-screen").classList.remove("hidden");
        showQuestion();
    }

    // è³ªå•è¡¨ç¤º
    function showQuestion() {
        const q = questions[currentQuestionIndex];
        const container = document.getElementById("question-container");
        
        // ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ç”¨ãƒªã‚»ãƒƒãƒˆ
        container.classList.remove("fade-in");
        void container.offsetWidth; // trigger reflow
        container.classList.add("fade-in");

        document.getElementById("question-text").innerText = q.text;
        
        const optionsDiv = document.getElementById("options-container");
        optionsDiv.innerHTML = "";

        // é€²æ—ãƒãƒ¼æ›´æ–°
        const progress = ((currentQuestionIndex) / questions.length) * 100;
        document.getElementById("progress").style.width = `${progress}%`;

        q.options.forEach(opt => {
            const btn = document.createElement("button");
            btn.innerText = opt.text;
            btn.onclick = () => handleAnswer(q, opt.value);
            optionsDiv.appendChild(btn);
        });
    }

    // å›ç­”å‡¦ç†
    function handleAnswer(question, value) {
        // ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼è¨­å®šã®ä¿å­˜
        if (question.type === "filter") {
            userPreferences[question.key] = value;
        }
        // æœ€çµ‚ã‚¹ã‚¤ãƒ¼ãƒ„ã®ä¿å­˜
        if (question.type === "target") {
            selectedSweet = value;
            showResult(); // æœ€å¾Œã®è³ªå•ãªã®ã§çµæœã¸
            return;
        }

        currentQuestionIndex++;
        if (currentQuestionIndex < questions.length) {
            showQuestion();
        } else {
            showResult(); // ä¸‡ãŒä¸€ã‚ªãƒ¼ãƒãƒ¼ã—ãŸå ´åˆ
        }
    }

    // çµæœè¨ˆç®—ã¨è¡¨ç¤º
    function showResult() {
        document.getElementById("quiz-screen").classList.add("hidden");
        document.getElementById("result-screen").classList.remove("hidden");

        const candidates = pairingsDB[selectedSweet] || pairingsDB["donut"]; // ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ
        let bestMatch = null;

        // å€™è£œã®ä¸­ã‹ã‚‰ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒé£²ã‚ã‚‹ä¸€ç•ªã‚¹ã‚³ã‚¢ãŒé«˜ã„ã‚‚ã®ã‚’æ¢ã™
        for (let drink of candidates) {
            if (drink.id === "coffee" && !userPreferences.canCoffee) continue;
            if (drink.id === "milk" && !userPreferences.canMilk) continue;
            if (drink.id === "tea" && !userPreferences.canTea) continue;
            if (drink.id === "green_tea" && !userPreferences.canGreenTea) continue;

            // ã“ã“ã¾ã§æ¥ãŸã‚‰é£²ã‚ã‚‹ã¨ã„ã†ã“ã¨
            bestMatch = drink;
            break; // ã‚¹ã‚³ã‚¢é †ã«ä¸¦ã‚“ã§ã„ã‚‹ã®ã§æœ€åˆã«è¦‹ã¤ã‹ã£ãŸã‚‚ã®ãŒãƒ™ã‚¹ãƒˆ
        }

        // å…¨æ»…ã—ãŸå ´åˆï¼ˆå…¨éƒ¨é£²ã‚ãªã„äººã¸ã®æ•‘æ¸ˆï¼‰
        if (!bestMatch) {
            bestMatch = {
                name: "ãŠæ°´ ã¾ãŸã¯ éº¦èŒ¶",
                score: "-",
                comment: "ã‚¹ã‚¤ãƒ¼ãƒ„ã®ç¹Šç´°ãªå‘³ã‚’é‚ªé­”ã—ãªã„ãŸã‚ã«ã¯ã€ãŠæ°´ã§å£ã®ä¸­ã‚’ãƒªã‚»ãƒƒãƒˆã™ã‚‹ã®ãŒä¸€ç•ªã§ã™ã€‚"
            };
        }

        // DOMã¸ã®åæ˜ 
        document.getElementById("result-drink").innerText = bestMatch.name;
        
        // ã‚¹ã‚³ã‚¢è¡¨ç¤ºï¼ˆå®Ÿé¨“ãƒ‡ãƒ¼ã‚¿ãŒã‚ã‚‹å ´åˆã®ã¿ï¼‰
        if(bestMatch.score !== "-") {
            // æ˜Ÿè©•ä¾¡ã«å¤‰æ›ï¼ˆç°¡æ˜“çš„ï¼‰
            let stars = "â˜…â˜…â˜…â˜†â˜†";
            if (bestMatch.score >= 3.8) stars = "â˜…â˜…â˜…â˜…â˜…";
            else if (bestMatch.score >= 3.0) stars = "â˜…â˜…â˜…â˜…â˜†";
            
            document.getElementById("result-score").innerText = `èª¿å’Œåº¦ã‚¹ã‚³ã‚¢: ${bestMatch.score} ${stars}`;
        } else {
            document.getElementById("result-score").innerText = "";
        }

        document.getElementById("result-science-comment").innerHTML = `<strong>ã€åˆ†æçµæœã€‘</strong><br>${bestMatch.comment}`;
        
        // ã‚¢ãƒ³ã‚±ãƒ¼ãƒˆçµæœã®è£œè¶³ï¼ˆãƒ©ãƒ³ãƒ€ãƒ ã¾ãŸã¯å›ºå®šï¼‰
        document.getElementById("result-survey-comment").innerText = 
            "â€»ã‚¢ãƒ³ã‚±ãƒ¼ãƒˆå‚åŠ è€…ã®å¤šããŒã€Œå¾Œå‘³ã®ã™ã£ãã‚Šæ„Ÿã€ã‚„ã€Œç”˜ã•ã®ãƒãƒ©ãƒ³ã‚¹ã€ã‚’é‡è¦–ã—ã¦ã„ã¾ã™ã€‚";
    }
</script>

</body>
</html>